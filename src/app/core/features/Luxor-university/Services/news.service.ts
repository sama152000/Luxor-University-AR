import { Injectable } from '@angular/core';
import { Observable, of } from 'rxjs';
import { News, NewsFilter, NewsResponse } from '../model/news.model';

@Injectable({
  providedIn: 'root'
})
export class NewsService {
  private mockNews: News[] = [
    {
      id: 1,
      title: 'جامعة الأقصر تشارك في مارathon عالمي للتوعية ضد شلل الأطفال',
      description: 'برعاية الدكتورة صبرين عبد الجليل، رئيسة جامعة الأقصر، شاركت الجامعة صباح اليوم في مارathon "سباق من أجل القضاء على الشلل" تحت شعار "الرياضة في خدمة الإنسانية"، بهدف التوعية بأهمية التطعيم ضد الشلل. انضم مئات الطلاب وممثلي المجتمع المدني والسياح المقيمين للحدث.',
      content: `برعاية **الأستاذة الدكتورة صبرين عبد الجليل**، رئيسة جامعة الأقصر، شاركت الجامعة صباح اليوم في مارathon "سباق من أجل القضاء على الشلل" تحت شعار "الرياضة في خدمة الإنسانية"، بهدف التوعية بأهمية التطعيم ضد الشلل.

شهد الحدث مشاركة جماهيرية من مئات الطلاب وممثلي المجتمع المدني والسياح المقيمين الذين انضموا للمارathon الذي انطلق من معبد الأقصر وامتد على كورنيش النيل مروراً بأهم المعالم الأثرية والسياحية في المدينة.

**أكدت الأستاذة الدكتورة صبرين عبد الجليل** أن هذه المشاركة تأتي في إطار التزام الجامعة بمسؤوليتها الاجتماعية ودورها في خدمة المجتمع، مشيرة إلى أن الرياضة وسيلة فعالة لنشر الوعي الصحي وتعزيز قيم التعاون والتكافل بين أفراد المجتمع.

تضمن المارathon نشاطات توعوية متنوعة حول أهمية التطعيم ضد الشلل، مع توزيع كتيبات توعوية وإقامة استشارات طبية للمشاركين. كما شهد الحدث عروضاً فنية أبرزت التراث الثقافي للأقصر وحضارتها العريقة.

تأتي هذه المبادرة ضمن الجهود العالمية للقضاء التام على الشلل، حيث تواصل جامعة الأقصر دعم الحملات الصحية الدولية والمساهمة في تحقيق أهداف التنمية المستدامة في مجال الصحة العامة.`,
      imageUrl: './assets/new1.jpg',
      images: [
        './assets/new1.jpg',
        './assets/new6.jpg',
        './assets/new7.jpg',
      ],
      date: new Date('2025-01-12'),
      author: 'د. أحمد حسن',
      category: 'فعاليات الجامعة',
      isFeatured: true,
      isBreaking: true,
      isTrending: true,
      views: 1250,
      tags: ['مارathon', 'صحة', 'خدمة مجتمع', 'توعية شلل']
    },
    {
      id: 2,
      title: 'ندوة توعوية حول الويب المظلم والحياة الرقمية بكلية الفنون الجميلة',
      description: 'برعاية الأستاذة الدكتورة صبرين عبد الجليل رئيسة جامعة الأقصر، نظم قطاع خدمة المجتمع وتنمية البيئة بإشراف الدكتورة هنا حامد بالتعاون مع الإدارة العامة لأنظمة المعلومات والتحول الرقمي ندوة حول "الويب المظلم والحياة الرقمية" بكلية الفنون الجميلة.',
      content: `برعاية **الأستاذة الدكتورة صبرين عبد الجليل** رئيسة جامعة الأقصر، نظم قطاع خدمة المجتمع وتنمية البيئة بإشراف **الدكتورة هنا حامد** بالتعاون مع الإدارة العامة لأنظمة المعلومات والتحول الرقمي، ندوة حول "الويب المظلم والحياة الرقمية" بكلية الفنون الجميلة بإشراف **الدكتور أحمد محيي** عميد الكلية.

هدفت الندوة للتوعية للطلاب وأعضاء هيئة التدريس بمخاطر الويب المظلم وكيفية حماية أنفسهم أثناء تصفحهم للعالم الرقمي. تضمن الحدث عروضاً من خبراء الأمن السيبراني تناولت أحدث اتجاهات التهديدات الرقمية وطرق الحماية.

**أكدت الدكتورة هنا حامد** على أهمية الثقافة الرقمية في عالمنا اليوم، مشيرة إلى أن فهم الفرص والمخاطر المتعلقة بالتكنولوجيا الرقمية أمر حاسم للنجاح الأكاديمي والشخصي. تناولت الندوة الموضوعات التالية:

- فهم هيكل الإنترنت والويب المظلم
- التعرف على التهديدات الرقمية وتجنبها
- أفضل الممارسات للخصوصية والأمان عبر الإنترنت
- دور المواطنة الرقمية في البيئات الأكاديمية

حضر الحدث أكثر من 200 طالب وعضو هيئة تدريس من مختلف الأقسام، مما يعكس الاهتمام الكبير بموضوعات الأمن الرقمي. أُقيمت ورش عمل تفاعلية لتوفير تجربة عملية مع أدوات وتقنيات الأمان.

تأتي هذه المبادرة ضمن استراتيجية جامعة الأقصر الشاملة للتحول الرقمي التي تهدف لخلق بيئة رقمية آمنة وواعية لجميع أعضاء مجتمع الجامعة.`,
      imageUrl: './assets/new2.jpg',
      images: [
        './assets/new2.jpg',
        './assets/new9.jpg',
        './assets/new8.jpg',
      ],
      date: new Date('2025-01-11'),
      author: 'د. هنا حامد',
      category: 'الأمن الرقمي',
      isFeatured: false,
      isBreaking: false,
      isTrending: true,
      views: 890,
      tags: ['أمن رقمي', 'ويب مظلم', 'أمن سيبراني', 'توعية طلاب']
    },
    {
      id: 3,
      title: 'جامعة الأقصر تدعم الطلاب المغتربين بمبادرة الدعم النفسي',
      description: 'برعاية الأستاذة الدكتورة صبرين جابر عبد الجليل رئيسة جامعة الأقصر، أطلق قطاع خدمة المجتمع وتنمية البيئة أول أنشطة مبادرة "الدعم النفسي للطلاب المغتربين" بنذوة توعوية بمهجع الطالبات بمدينة طيبة.',
      content: `برعاية **الأستاذة الدكتورة صبرين جابر عبد الجليل** رئيسة جامعة الأقصر، أطلق قطاع خدمة المجتمع وتنمية البيئة أول أنشطة مبادرة "الدعم النفسي للطلاب المغتربين" بنذوة توعوية بمهجع الطالبات بمدينة طيبة.

قدمت الندوة **الأستاذ الدكتور هاني عبد الفتاح** مدير مكتب الدعم النفسي، و**الأستاذ المساعد الدكتور رضا عطا الله** منسق التواصل المجتمعي بالجامعة، بحضور **الدكتور أحمد يوسف** المدير العام لمهاجع الجامعة.

تهدف المبادرة لتوفير دعم نفسي شامل للطلاب البعيدين عن أسرهم وبلدانهم، لمساعدتهم على التأقلم مع الحياة الجامعية والتغلب على التحديات التي قد يواجهونها خلال رحلتهم الأكاديمية.

**أوضح الأستاذ الدكتور هاني عبد الفتاح** أن البرنامج يشمل:

- جلسات استشارية فردية وجماعية
- ورش عمل إدارة الضغط
- أنشطة التكامل الاجتماعي
- شبكات الدعم بين الأقران
- خدمات التدخل في الأزمات

تناولت الندوة مواضيع هامة مثل إدارة الشوق للوطن، بناء علاقات صحية، إدارة ضغط الدراسة، وتطوير استراتيجيات مواجهة لمختلف تحديات الحياة.

**أكد الدكتور رضا عطا الله** التزام الجامعة بخلق بيئة داعمة لجميع الطلاب، مشيراً إلى أن الصحة النفسية مهمة مثل النجاح الأكاديمي. ستتوسع المبادرة لتشمل مهاجع الطلاب الذكور والطلاب خارج الحرم الجامعي خلال الأسابيع القادمة.

يعكس هذا البرنامج نهج جامعة الأقصر الشامل لرفاهية الطلاب واعترافها بالتحديات الفريدة التي يواجهها الطلاب الدارسون بعيداً عن الوطن.`,
      imageUrl: './assets/new3.jpg',
      images: [
        './assets/new3.jpg',
        './assets/new3.jpg',
        './assets/new3.jpg',
      ],
      date: new Date('2025-01-10'),
      author: 'د. هاني عبد الفتاح',
      category: 'دعم الطلاب',
      isFeatured: false,
      isBreaking: false,
      isTrending: false,
      views: 650,
      tags: ['دعم نفسي', 'رفاهية طلاب', 'صحة نفسية', 'طلاب مغتربين']
    },
    {
      id: 4,
      title: 'جامعة الأقصر تنعى العالم الجليل الدكتور أحمد عمر هاشم',
      description: 'تنعى جامعة الأقصر بحزن عميق وفاة العالم الجليل الدكتور أحمد عمر هاشم، الرئيس السابق لجامعة الأزهر وعضو هيئة كبار العلماء بالأزهر. الأستاذة الدكتورة صبرين عبد الجليل رئيسة جامعة الأقصر تعرب عن خالص تعازيها لأسرته وطلابه ومحبيه.',
      content: `تنعى جامعة الأقصر بحزن عميق وفاة العالم الجليل **الدكتور أحمد عمر هاشم**، الرئيس السابق لجامعة الأزهر وعضو هيئة كبار العلماء بالأزهر. **الأستاذة الدكتورة صبرين عبد الجليل** رئيسة جامعة الأقصر تعرب عن خالص تعازيها لأسرته وطلابه ومحبيه، داعية الله أن يتغمد الفقيد بواسع رحمته وأن يسكنه فسيح جناته.

كان **الدكتور أحمد عمر هاشم** رمزاً بارزاً في العلم الإسلامي والتعليم، حيث تولى رئاسة جامعة الأزهر من 1996 إلى 2005. إسهاماته في الفقه الإسلامي والتعليم والحوار بين الأديان تركت بصمة لا تُمحى في المجتمعات الأكاديمية والدينية على مستوى العالم.

طوال مسيرته العلمية المضيئة، اشتهر الدكتور هاشم بنهجه المعتدل في العلم الإسلامي وجهوده لتعزيز التفاهم بين الثقافات والأديان المختلفة. ألف العديد من الكتب وأوراق البحث في الفقه الإسلامي والعقيدة والقضايا المعاصرة التي تواجه العالم الإسلامي.

**قالت الأستاذة الدكتورة صبرين عبد الجليل**: "وفاة الدكتور أحمد عمر هاشم خسارة كبيرة ليس فقط للأزهر ومصر بل للعالم الإسلامي بأسره. حكمته وعلمه وتفانيه في التعليم ألهمت أجيالاً من الطلاب والعلماء. في جامعة الأقصر نتذكر إسهاماته في التعليم العالي وتفانيه في نشر العلم والتفاهم."

شملت إرث الدكتور هاشم دوره في تحديث منهج جامعة الأزهر مع الحفاظ على قيمها الإسلامية التقليدية، وجهوده في تعزيز تعليم المرأة في المؤسسات الإسلامية، وعملَه في تعزيز الحوار بين المؤسسات التعليمية الإسلامية والغربية.

ينضم مجتمع الجامعة للأمة في نعي هذا الخسارت الكبيرة ويدعو لروح الفقيد ولعائلته بالصبر والسلوان في هذه المحنة الصعبة.`,
      imageUrl: './assets/new4.jpg',
      images: [
        './assets/new4.jpg',
      ],
      date: new Date('2025-01-09'),
      author: 'إدارة الاتصالات الجامعية',
      category: 'أخبار الجامعة',
      isFeatured: false,
      isBreaking: true,
      isTrending: false,
      views: 1100,
      tags: ['نعي', 'عالم إسلامي', 'الأزهر', 'تعليم']
    },
    {
      id: 5,
      title: 'رئيسة جامعة الأقصر تهنئ الدكتور خالد الإناني على فوزه بمنصب المدير العام لليونسكو',
      description: 'الأستاذة الدكتورة صبرين عبد الجليل رئيسة جامعة الأقصر تهنئ الدكتور خالد الإناني على انتخابه مديراً عاماً لليونسكو بحصوله على 55 من أصل 57 صوتاً، مؤكدة أن هذا الإنجاز التاريخي يُضاف لسجل مصر الدبلوماسي والثقافي.',
      content: `**الأستاذة الدكتورة صبرين عبد الجليل** رئيسة جامعة الأقصر تهنئ **الدكتور خالد الإناني** على انتخابه مديراً عاماً لليونسكو بحصوله على 55 من أصل 57 صوتاً. أكدت أن هذا الإنجاز التاريخي يُضاف لسجل مصر الدبلوماسي والثقافي، ويعكس المكانة الحضارية للبلاد والثقة العالمية في التميز والقيادة المصرية.

يُمثل انتخاب الدكتور الإناني محطة بارزة لمصر والعالم العربي، كونه أول مصري يتولى هذا المنصب المرموق في تاريخ اليونسكو. خبرته الواسعة في علم الآثار وحفظ التراث الثقافي والتعاون الدولي جعلته المرشح المثالي لهذا الدور.

**قالت الأستاذة الدكتورة صبرين عبد الجليل**: "انتخاب الدكتور الإناني مديراً عاماً لليونسكو مصدر فخر عظيم لكل المصريين. فهمه العميق للتراث الثقافي مع رؤيته للتعليم والتعاون العلمي سيفيد ليس مصر فحسب بل المجتمع الدولي بأسره."

شغل الدكتور الإناني منصب وزير السياحة والآثار بمصر حيث لعب دوراً حاسماً في الترويج للتراث الثقافي والكنوز الأثرية لمصر. عمله في تطوير ممارسات السياحة المستدامة وحماية الآثار القديمة حاز على تقدير دولي.

كمدير عام لليونسكو، من المتوقع أن يركز الدكتور الإناني على:

- تعزيز التعاون الدولي في التعليم والعلم والثقافة
- الترويج للتنوع الثقافي وحفظ التراث
- تطوير التحول الرقمي في التعليم
- دعم الدول النامية في بناء القدرات
- تعزيز السلام من خلال التعليم والتبادل الثقافي

تنتظر جامعة الأقصر، بقربها من بعض أهم المواقع الأثرية في العالم، تعاوناً مُحسَّناً مع اليونسكو تحت قيادة الدكتور الإناني، خاصة في مجالات البحث الأثري وحفظ التراث والبرامج التعليمية التبادلية.`,
      imageUrl: './assets/new5.jpg',
      images: [
        './assets/new5.jpg',
      ],
      date: new Date('2025-01-08'),
      author: 'إدارة الاتصالات الجامعية',
      category: 'أخبار دولية',
      isFeatured: true,
      isBreaking: false,
      isTrending: true,
      views: 980,
      tags: ['يونسكو', 'تقدير دولي', 'تراث ثقافي', 'إنجاز مصري']
    },
    {
      id: 6,
      title: 'اكتشاف أثري جديد بمعبد الأقصر يكشف كتابات فرعونية قديمة',
      description: 'بعثة أثرية مشتركة من جامعة الأقصر ووزارة السياحة والآثار تكتشف كتابات فرعونية رائعة تعود لعهد رمسيس الثاني بمعبد الأقصر، توفر رؤى جديدة حول الممارسات الدينية المصرية القديمة.',
      content: `بعثة أثرية مشتركة من **جامعة الأقصر** و**وزارة السياحة والآثار** تكتشف كتابات فرعونية رائعة تعود لعهد **رمسيس الثاني** بمعبد الأقصر، توفر رؤى جديدة حول الممارسات الدينية والطقوس الملكية المصرية القديمة.

أعلن عن الاكتشاف اليوم **الأستاذة الدكتورة صبرين عبد الجليل** رئيسة جامعة الأقصر، و**الدكتور مصطفى وزيري** الأمين العام للمجلس الأعلى للآثار، ويتضمن سلسلة من الكتابات الهيروغليفية المحفوظة جيداً التي تفصل الطقوس الدينية المُنْجَزَة خلال عيد أبيت السنوي.

**أوضح الدكتور أحمد فرج** رئيس قسم الآثار بجامعة الأقصر وقائد فريق الحفر، أن الكتابات عُثر عليها في قسم سابقاً غير مستكشف من جدار المعبد الشرقي. تصف النصوص رحلة الإله آمون المقدسة من معبد الكرنك إلى معبد الأقصر، وهي عنصر مركزي في عيد أبيت.

تتضمن الكتابات المكتشفة حديثاً:

- وصف مفصل للقرابين الطقسية المُقَدَّمَة لآمون-رع
- أسماء كهنة وموظفي معبد غير معروفين سابقاً
- إشارات لمراسم محددة أُجريت خلال العيد
- تصوير فني لموكب القارب المقدس

**أكدت الأستاذة الدكتورة صبرين عبد الجليل** أهمية هذا الاكتشاف: "هذا الاكتشاف لا يعزز فهمنا للممارسات الدينية المصرية القديمة فحسب، بل يُظْهِر أيضاً الدور المهم الذي تلعبه جامعة الأقصر في حفظ ودراسة تراثنا الثقافي الغني. طلابنا وأعضاء هيئة التدريس يساهمون مباشرة في توسيع المعرفة البشرية حول واحدة من أعظم الحضارات في العالم."

الاكتشاف ذو أهمية خاصة لأنه يوفر أدلة جديدة حول استمرارية الممارسات الدينية خلال عصر المملكة الحديثة ويقدم رؤى حول الهيكل الإداري لمعابد مصر القديمة.

استخدم فريق الحفر، الذي يشمل طلاب قسم الآثار بجامعة الأقصر، تقنيات توثيق رقمية متقدمة لتسجيل الكتابات. سيُنْشَرُ النتائج في العدد القادم من مجلة علم الآثار المصرية.

تُدَارُ خطط لجعل الكتابات المكتشفة الجديدة متاحة للزوار من خلال معرض خاص في متحف الأقصر، بالتعاون مع وزارة السياحة والآثار.`,
      imageUrl: './assets/new7.jpg',
      images: [
        './assets/new7.jpg',
      ],
      date: new Date('2025-01-07'),
      author: 'د. أحمد فرج',
      category: 'اكتشاف أثري',
      isFeatured: true,
      isBreaking: true,
      isTrending: true,
      views: 1500,
      tags: ['آثار', 'فرعوني', 'معبد الأقصر', 'رمسيس الثاني', 'هيروغليفية']
    }
  ];

  getLatestNews(): News[] {
    return this.mockNews.sort((a, b) => b.date.getTime() - a.date.getTime());
  }

  getFeaturedNews(): News | undefined {
    return this.mockNews.find(news => news.isFeatured);
  }

  getBreakingNews(): News[] {
    return this.mockNews.filter(news => news.isBreaking).slice(0, 3);
  }

  getTrendingNews(): News[] {
    return this.mockNews.filter(news => news.isTrending).slice(0, 5);
  }

  getMostReadNews(): News[] {
    return this.mockNews.sort((a, b) => b.views - a.views).slice(0, 5);
  }

  getNewsByCategory(category: string): News[] {
    return this.mockNews.filter(news => news.category === category);
  }

  getNewsById(id: number): Observable<News | undefined> {
    const news = this.mockNews.find(n => n.id === id);
    return of(news);
  }

  getRelatedNews(currentId: number, category: string, limit: number = 5): Observable<News[]> {
    const related = this.mockNews
      .filter(news => news.id !== currentId && news.category === category)
      .slice(0, limit);
    return of(related);
  }

  getNews(filter?: NewsFilter, page: number = 1, pageSize: number = 6): Observable<NewsResponse> {
    let filteredNews = [...this.mockNews];

    if (filter) {
      if (filter.category) {
        filteredNews = filteredNews.filter(news => news.category === filter.category);
      }
      
      if (filter.searchTerm) {
        const searchTerm = filter.searchTerm.toLowerCase();
        filteredNews = filteredNews.filter(news =>
          news.title.toLowerCase().includes(searchTerm) ||
          news.description.toLowerCase().includes(searchTerm) ||
          news.tags.some(tag => tag.toLowerCase().includes(searchTerm))
        );
      }
      
      if (filter.dateFrom) {
        filteredNews = filteredNews.filter(news => news.date >= filter.dateFrom!);
      }
      
      if (filter.dateTo) {
        filteredNews = filteredNews.filter(news => news.date <= filter.dateTo!);
      }
    }

    filteredNews.sort((a, b) => b.date.getTime() - a.date.getTime());

    const startIndex = (page - 1) * pageSize;
    const endIndex = startIndex + pageSize;
    const paginatedNews = filteredNews.slice(startIndex, endIndex);

    return of({
      items: paginatedNews,
      total: filteredNews.length,
      page,
      pageSize
    });
  }

  getCategories(): Observable<string[]> {
    const categories = [...new Set(this.mockNews.map(news => news.category))];
    return of(categories);
  }

  getNextNews(currentId: number): Observable<News | null> {
    const currentIndex = this.mockNews.findIndex(news => news.id === currentId);
    if (currentIndex === -1 || currentIndex === this.mockNews.length - 1) {
      return of(null);
    }
    return of(this.mockNews[currentIndex + 1]);
  }

  getPreviousNews(currentId: number): Observable<News | null> {
    const currentIndex = this.mockNews.findIndex(news => news.id === currentId);
    if (currentIndex === -1 || currentIndex === 0) {
      return of(null);
    }
    return of(this.mockNews[currentIndex - 1]);
  }
}